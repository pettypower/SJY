# CSS权重详解

> 撰稿人：邹强  
> 基本简介：CSS权重详解笔记  
> 作成时间：2019-7-30  
> 修改时间：2019-7-30

[原文链接](https://justcoding.iteye.com/blog/2312385)

## 定义

1. CSS选择器权重分四个等级
    - A: 内联样式
    - B: ID的数量
    - C: 伪类及其它属性的数量(class, 属性,不包括伪元素)
    - D: 伪元素及标签的数量

2. 范例

    ```css
        *             {}  /* a=0 b=0 c=0 d=0 -> specificity = 0,0,0,0 */  
        li            {}  /* a=0 b=0 c=0 d=1 -> specificity = 0,0,0,1 */  
        li:first-line {}  /* a=0 b=0 c=0 d=2 -> specificity = 0,0,0,2 */  
        ul li         {}  /* a=0 b=0 c=0 d=2 -> specificity = 0,0,0,2 */  
        ul ol+li      {}  /* a=0 b=0 c=0 d=3 -> specificity = 0,0,0,3 */  
        h1 + *[rel=up]{}  /* a=0 b=0 c=1 d=1 -> specificity = 0,0,1,1 */  
        ul ol li.red  {}  /* a=0 b=0 c=1 d=3 -> specificity = 0,0,1,3 */  
        li.red.level  {}  /* a=0 b=0 c=2 d=1 -> specificity = 0,0,2,1 */  
        #x34y         {}  /* a=0 b=1 c=0 d=0 -> specificity = 0,1,0,0 */  
        style=""          /* a=1 b=0 c=0 d=0 -> specificity = 1,0,0,0 */  
    ```

3. 权重值比较规则

    1. A,B,C,D四组值，从左到右，分组比较，如果A相同，比较B，如果B相同，比较C，如果C相同，比较D，如果D相同，后定义的优先。

    2. 注意前提: 这种方式比较的前提是最后是要落在同一个tag上面的. 上面的例子 .count 和 em 应该是同一个tag, 如果落脚点的tag不一样的话,那就是就近原则, 而不能够再用权重值的比较了!

    3. !important 用于单独指定某条样式中的单个属性。对于被指定的属性，有 !important 指定的权重值大于所有未用 !important 指定的规则。

        - 样式一

        ``` css
            /* 权值 = 0-1-1-3*/
            #header nav ul li.current {color: red; font-weight: bold;}
        ```

        - 样式二

        ``` css
            /* 权值 = 0-0-2-0*/
            li:hover {color: blue !important; font-weight: normal;}
        ```

        > 结论:就整条规则而言，样式一的权重值为 0, 1, 1, 3，而样式二的权重值仅为0, 0, 2, 0。所以应用于相同元素时，应该样式一生效。但是对于color这个属性，由于在样式二中用 !important 做了指定，因此color将应用样式二的规则。而font-weight则按照规定用样式一的规则。**所以最好的办法就是：不要使用 !important。**

4. 关于inherit(继承)

    ``` html
        <style>  
            .list .item { color: red }  
        </style>  
        <ul class="list">  
            <li class="item">  
                <span>某些文字</span>  
            </li>  
        </ul>  
    ```

    > 样式规则并未针对 span 标签指定 color 属性， 但是 span 中的文字会显示为红色， 这就是因为 span 的 color 属性默认值为 inherit.
    > 只要记住一点： 继承而来的属性值，权重永远低于明确指定到元素的定义。只有当一个元素的某个属性没有被直接指定时，才会继承父级元素的值

    ```html
        <style>  
            span { color: blue }  
            .list .item { color: red }  
        </style>  
        <ul class="list">  
            <li class="item">  
                <span>某些文字</span>  
            </li>  
        </ul>
    ```

    > 同样的例子， 第一条规则的权重是 0,0,0,1, 第二条规则的权重是 0,0,2,0. 虽然第二条规则的权重更高，但是它是针对 li 元素的直接指定，并不是针对 span 元素定义的，所以计算 span 的 color 属性权重值时，实际上就是 inherit 的红色与直接指定的蓝色的对比。按照规则，只要有直接指定的值（蓝色），就不会再取继承的值（红色），所以 span 中的文字显示为蓝色。

    ``` html
        <style>
            a { color: inherit; text-decoration: inherit }
            .item { color:red }
        </style>
        <p class="item"><a href="#">链接文字</a></p>
    ```

    > 由于一般浏览器自带的样式表都有针对 a 标签的颜色及下划线的直接指定，所以网页样式表中对 a 标签的父级元素指定 color 属性及 text-decoration 属性，通常不会起作用。
    > 在上例中，由于我们的样式表对 a 标签直接指定了 color 和 text-decoration 属性值， 覆盖了浏览器的默认样式，所以在没有特别指定 a 标签的颜色和下划线定义的前提下， 会从父级元素 p 继承，因此链接会显示为红色

## 总结

### 一条样式规则的整体权重值包含四个独立的部分：[A, B, C, D]

1. A 表示内联样式，只有 1 或者 0 两个值
2. B 表示规则中 ID 的数量
3. C 表示规则中除了 ID、标签和伪元素以外的其它选择器数量
4. D 表示规则中标签和伪元素的数量
5. 比较时从高位到低位（从 A 到 D）分别比较，高位相同才需要比较低位
6. 有 !important 标记的属性权重值无视没用 !important 指定的一切情况
7. 多次指定 !important 时，相互抵销
8. inherit 而来的属性定义，优先级低于任何直接指定的属性值
